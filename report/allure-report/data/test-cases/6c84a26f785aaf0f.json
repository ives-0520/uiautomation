{"uid":"6c84a26f785aaf0f","name":"test_recharge_flow[0609@ipwangxin.cn-123456-1158472753844023]","fullName":"testCase.testApp.recharge.test_obj_recharge#test_recharge_flow","historyId":"6cc58c2c26b19a8db30d8d796e9eb075","time":{"start":1750225814130,"stop":1750225839093,"duration":24963},"status":"failed","statusMessage":"AssertionError: 充值流程断言失败，未检测到充值成功的标志性元素\nassert '\\u6210\\u529f' in '\\u5224\\u65ad\\u7ed3\\u679c\\uff1a\\u5931\\u8d25\\n\\u5931\\u8d25\\u539f\\u56e0\\uff1a\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09'","statusTrace":"app_init = (<uiautomator2.Device object at 0x000002B1AA98F410>, <device.device_init.appOpt object at 0x000002B1C2F00560>, <config...ct at 0x000002B1C1743950>, <element_manage.element_locator_manager.ElementLocatorManager object at 0x000002B1C2DDA8D0>)\nusername = '0609@ipwangxin.cn', password = '123456', code = '1158472753844023'\n\n    @allure.story(\"充值功能\")\n    @pytest.mark.parametrize(\"username, password, code\", recharge_test_data)\n    def test_recharge_flow(app_init, username, password, code):\n        device = app_init[0]\n        app = app_init[1]\n        app.startApp()\n        time.sleep(3)\n        manager = app_init[3]\n        # 登录\n        login_obj = obj_login(device, manager)\n        login_obj.login(username, password)\n        app.click_(app.manager.get_locator(\"imageView\").locator )\n    \n        # 充值\n        recharge_obj = obj_recharge(device, manager)\n        recharge_obj.recharge_flow(code)\n        # 截图保存\n        case_dir = os.path.dirname(os.path.abspath(__file__))\n        screenshot_dir = os.path.join(case_dir, \"images\")\n        os.makedirs(screenshot_dir, exist_ok=True)\n        screenshot_path = os.path.join(screenshot_dir, f\"screenshot_recharge_{int(time.time())}.png\")\n        screenshot_dir = os.path.join(os.getcwd(), \"screenshots\")\n        device.screenshot(screenshot_path)\n        allure.attach.file(screenshot_path, name=\"充值后截图\", attachment_type=allure.attachment_type.PNG)\n        # 断言：检查页面是否有充值成功后的元素（如头像或其他标志性元素）\n        # assert recharge_obj.is_el_exists(recharge_obj.manager.get_locator(\"imageView\").locator), \"断言失败\"\n        locator = ImageLocator()\n        assert_result=locator.ai_assert(screenshot_path, \"判断是否充值成功，并返回判断结果成功或失败以及失败原因\")\n        logging.info(f\"充值结果断言: {assert_result}\")\n>       assert \"成功\" in assert_result, \"充值流程断言失败，未检测到充值成功的标志性元素\"\nE       AssertionError: 充值流程断言失败，未检测到充值成功的标志性元素\nE       assert '\\u6210\\u529f' in '\\u5224\\u65ad\\u7ed3\\u679c\\uff1a\\u5931\\u8d25\\n\\u5931\\u8d25\\u539f\\u56e0\\uff1a\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09'\n\ntestCase\\testApp\\recharge\\test_obj_recharge.py:45: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":14,"retriesStatusChange":true,"beforeStages":[{"name":"app_init","time":{"start":1750225814062,"stop":1750225814130,"duration":68},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"stepsCount":0}],"testStage":{"status":"failed","statusMessage":"AssertionError: 充值流程断言失败，未检测到充值成功的标志性元素\nassert '\\u6210\\u529f' in '\\u5224\\u65ad\\u7ed3\\u679c\\uff1a\\u5931\\u8d25\\n\\u5931\\u8d25\\u539f\\u56e0\\uff1a\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09'","statusTrace":"app_init = (<uiautomator2.Device object at 0x000002B1AA98F410>, <device.device_init.appOpt object at 0x000002B1C2F00560>, <config...ct at 0x000002B1C1743950>, <element_manage.element_locator_manager.ElementLocatorManager object at 0x000002B1C2DDA8D0>)\nusername = '0609@ipwangxin.cn', password = '123456', code = '1158472753844023'\n\n    @allure.story(\"充值功能\")\n    @pytest.mark.parametrize(\"username, password, code\", recharge_test_data)\n    def test_recharge_flow(app_init, username, password, code):\n        device = app_init[0]\n        app = app_init[1]\n        app.startApp()\n        time.sleep(3)\n        manager = app_init[3]\n        # 登录\n        login_obj = obj_login(device, manager)\n        login_obj.login(username, password)\n        app.click_(app.manager.get_locator(\"imageView\").locator )\n    \n        # 充值\n        recharge_obj = obj_recharge(device, manager)\n        recharge_obj.recharge_flow(code)\n        # 截图保存\n        case_dir = os.path.dirname(os.path.abspath(__file__))\n        screenshot_dir = os.path.join(case_dir, \"images\")\n        os.makedirs(screenshot_dir, exist_ok=True)\n        screenshot_path = os.path.join(screenshot_dir, f\"screenshot_recharge_{int(time.time())}.png\")\n        screenshot_dir = os.path.join(os.getcwd(), \"screenshots\")\n        device.screenshot(screenshot_path)\n        allure.attach.file(screenshot_path, name=\"充值后截图\", attachment_type=allure.attachment_type.PNG)\n        # 断言：检查页面是否有充值成功后的元素（如头像或其他标志性元素）\n        # assert recharge_obj.is_el_exists(recharge_obj.manager.get_locator(\"imageView\").locator), \"断言失败\"\n        locator = ImageLocator()\n        assert_result=locator.ai_assert(screenshot_path, \"判断是否充值成功，并返回判断结果成功或失败以及失败原因\")\n        logging.info(f\"充值结果断言: {assert_result}\")\n>       assert \"成功\" in assert_result, \"充值流程断言失败，未检测到充值成功的标志性元素\"\nE       AssertionError: 充值流程断言失败，未检测到充值成功的标志性元素\nE       assert '\\u6210\\u529f' in '\\u5224\\u65ad\\u7ed3\\u679c\\uff1a\\u5931\\u8d25\\n\\u5931\\u8d25\\u539f\\u56e0\\uff1a\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09'\n\ntestCase\\testApp\\recharge\\test_obj_recharge.py:45: AssertionError","steps":[],"attachments":[{"uid":"491b2ccfb6796dc4","name":"充值后截图","source":"491b2ccfb6796dc4.png","type":"image/png","size":176082},{"uid":"eb0a339a74291007","name":"adb_screenshot_test_recharge_flow[0609@ipwangxin.cn-123456-1158472753844023]","source":"eb0a339a74291007.png","type":"image/png","size":50178},{"uid":"5360ef924e41a585","name":"logcat_test_recharge_flow[0609@ipwangxin.cn-123456-1158472753844023]","source":"5360ef924e41a585.txt","type":"text/plain","size":1295309},{"uid":"32e6e8332c9b9a3a","name":"log","source":"32e6e8332c9b9a3a.txt","type":"text/plain","size":936}],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":4,"hasContent":true,"attachmentStep":false,"stepsCount":0},"afterStages":[{"name":"app_init::0","time":{"start":1750225839504,"stop":1750225839686,"duration":182},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"stepsCount":0}],"labels":[{"name":"story","value":"充值功能"},{"name":"parentSuite","value":"testCase.testApp.recharge"},{"name":"suite","value":"test_obj_recharge"},{"name":"host","value":"Ives-win10"},{"name":"thread","value":"14532-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"testCase.testApp.recharge.test_obj_recharge"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"code","value":"'1158472753844023'"},{"name":"password","value":"'123456'"},{"name":"username","value":"'0609@ipwangxin.cn'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"b21f6dcb86a2d531","status":"failed","statusDetails":"AssertionError: 充值流程断言失败，未检测到充值成功的标志性元素\nassert '\\u6210\\u529f' in '\\u5931\\u8d25'","time":{"start":1750225703215,"stop":1750225729403,"duration":26188}},{"uid":"92e1c75da0b7b089","status":"passed","time":{"start":1750225544835,"stop":1750225570942,"duration":26107}},{"uid":"7e9c233358cc2110","status":"passed","time":{"start":1750225383559,"stop":1750225409672,"duration":26113}},{"uid":"5710a36e0c51de05","status":"passed","time":{"start":1750225141310,"stop":1750225168143,"duration":26833}},{"uid":"175387854374a054","status":"broken","statusDetails":"uiautomator2.exceptions.UiObjectNotFoundError: (-32001, 'androidx.test.uiautomator.UiObjectNotFoundException', ({'mask': 2097152, 'childOrSibling': [], 'childOrSiblingSelector': [], 'resourceId': 'tech.gtt.frontapp.stb.demo:id/recharge_code_confirm'},))","time":{"start":1750225006523,"stop":1750225029259,"duration":22736}},{"uid":"c58c33d986a30ff7","status":"passed","time":{"start":1750161337617,"stop":1750161359633,"duration":22016}},{"uid":"9d11cf5ff642c7f5","status":"passed","time":{"start":1750160692605,"stop":1750160711456,"duration":18851}},{"uid":"11d18d10e9b4d18a","status":"passed","time":{"start":1750160517648,"stop":1750160537216,"duration":19568}},{"uid":"502b1b4c825cc83f","status":"broken","statusDetails":"uiautomator2.exceptions.UiObjectNotFoundError: {'code': -32002, 'data': \"Selector [resourceId='tech.gtt.frontapp.stb.demo:id/et_recharge_code']\", 'method': 'wait'}","time":{"start":1750160415047,"stop":1750160453418,"duration":38371}},{"uid":"147cdbfb5943e874","status":"broken","statusDetails":"AttributeError: 'dict' object has no attribute 'xpath'","time":{"start":1750160352302,"stop":1750160370143,"duration":17841}},{"uid":"3c384cc0bc5c4c9a","status":"broken","statusDetails":"AttributeError: 'NoneType' object has no attribute 'click'","time":{"start":1750160180104,"stop":1750160203156,"duration":23052}},{"uid":"8dd081c8b65e16ae","status":"broken","statusDetails":"AttributeError: 'NoneType' object has no attribute 'click'","time":{"start":1750160089454,"stop":1750160113047,"duration":23593}},{"uid":"784280f68cc34a32","status":"broken","statusDetails":"AttributeError: 'NoneType' object has no attribute 'click'","time":{"start":1750159113382,"stop":1750159136736,"duration":23354}},{"uid":"fcaf6d0cb5fd59e6","status":"broken","statusDetails":"AttributeError: 'NoneType' object has no attribute 'click'","time":{"start":1750158832506,"stop":1750158851918,"duration":19412}}],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":[]},"source":"6c84a26f785aaf0f.json","parameterValues":["'1158472753844023'","'123456'","'0609@ipwangxin.cn'"]}