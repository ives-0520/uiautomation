{"uid":"318aa8b4cc6de5f5","name":"test_recharge_flow[0609@ipwangxin.cn-123456-0032585037446681]","fullName":"testCase.testApp.recharge.test_obj_recharge#test_recharge_flow","historyId":"302f03486f096f5c0da568c0240c5c9b","time":{"start":1750731588198,"stop":1750731615489,"duration":27291},"status":"failed","statusMessage":"AssertionError: 充值流程断言失败，失败，失败原因是充值卡无效（对应提示信息“10031:Invalid Recharge Card.”）。\nassert '\\u6210\\u529f' in '\\u5931\\u8d25\\uff0c\\u5931\\u8d25\\u539f\\u56e0\\u662f\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09\\u3002'","statusTrace":"app_init = (<uiautomator2.Device object at 0x0000024AEC50BA10>, <device.device_init.appOpt object at 0x0000024AEE08B1D0>, <config...ct at 0x0000024AEE08BA70>, <element_manage.element_locator_manager.ElementLocatorManager object at 0x0000024AEE08B8C0>)\nusername = '0609@ipwangxin.cn', password = '123456', code = '0032585037446681'\n\n    @allure.story(\"充值功能\")\n    @pytest.mark.parametrize(\"username, password, code\", recharge_test_data)\n    def test_recharge_flow(app_init, username, password, code):\n        device = app_init[0]\n        app = app_init[1]\n        app.startApp()\n        time.sleep(3)\n        manager = app_init[3]\n        # 登录\n        login_obj = obj_login(device, manager)\n        login_obj.login(username, password)\n        app.click_(app.manager.get_locator(\"imageView\").locator )\n    \n        # 充值\n        recharge_obj = obj_recharge(device, manager)\n        recharge_obj.recharge_flow(code)\n        time.sleep(2.5)  # 等待充值流程完成\n        # 充值后截图保存\n        case_dir = os.path.dirname(os.path.abspath(__file__))\n        screenshot_dir = os.path.join(case_dir, \"images\")\n        os.makedirs(screenshot_dir, exist_ok=True)\n        screenshot_path = os.path.join(\n            screenshot_dir, f\"screenshot_recharge_{time.strftime('%Y%m%d_%H%M%S')}.png\"\n        )\n        screenshot_dir = os.path.join(os.getcwd(), \"screenshots\")\n        device.screenshot(screenshot_path)\n        allure.attach.file(screenshot_path, name=\"充值后截图\", attachment_type=allure.attachment_type.PNG)\n        # 断言：检查页面是否有充值成功后的元素（如头像或其他标志性元素）\n        # assert recharge_obj.is_el_exists(recharge_obj.manager.get_locator(\"imageView\").locator), \"断言失败\"\n        locator = ImageAI()\n        assert_result=locator.ai_assert(screenshot_path, \"判断是否充值成功，并返回判断结果成功或失败，若失败，附上失败原因\")\n        logging.info(f\"充值结果: {assert_result}\")\n>       assert \"成功\" in assert_result, f\"充值流程断言失败，{assert_result}\"\nE       AssertionError: 充值流程断言失败，失败，失败原因是充值卡无效（对应提示信息“10031:Invalid Recharge Card.”）。\nE       assert '\\u6210\\u529f' in '\\u5931\\u8d25\\uff0c\\u5931\\u8d25\\u539f\\u56e0\\u662f\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09\\u3002'\n\ntestCase\\testApp\\recharge\\test_obj_recharge.py:48: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":true,"beforeStages":[{"name":"app_init","time":{"start":1750731588035,"stop":1750731588197,"duration":162},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"testStage":{"status":"failed","statusMessage":"AssertionError: 充值流程断言失败，失败，失败原因是充值卡无效（对应提示信息“10031:Invalid Recharge Card.”）。\nassert '\\u6210\\u529f' in '\\u5931\\u8d25\\uff0c\\u5931\\u8d25\\u539f\\u56e0\\u662f\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09\\u3002'","statusTrace":"app_init = (<uiautomator2.Device object at 0x0000024AEC50BA10>, <device.device_init.appOpt object at 0x0000024AEE08B1D0>, <config...ct at 0x0000024AEE08BA70>, <element_manage.element_locator_manager.ElementLocatorManager object at 0x0000024AEE08B8C0>)\nusername = '0609@ipwangxin.cn', password = '123456', code = '0032585037446681'\n\n    @allure.story(\"充值功能\")\n    @pytest.mark.parametrize(\"username, password, code\", recharge_test_data)\n    def test_recharge_flow(app_init, username, password, code):\n        device = app_init[0]\n        app = app_init[1]\n        app.startApp()\n        time.sleep(3)\n        manager = app_init[3]\n        # 登录\n        login_obj = obj_login(device, manager)\n        login_obj.login(username, password)\n        app.click_(app.manager.get_locator(\"imageView\").locator )\n    \n        # 充值\n        recharge_obj = obj_recharge(device, manager)\n        recharge_obj.recharge_flow(code)\n        time.sleep(2.5)  # 等待充值流程完成\n        # 充值后截图保存\n        case_dir = os.path.dirname(os.path.abspath(__file__))\n        screenshot_dir = os.path.join(case_dir, \"images\")\n        os.makedirs(screenshot_dir, exist_ok=True)\n        screenshot_path = os.path.join(\n            screenshot_dir, f\"screenshot_recharge_{time.strftime('%Y%m%d_%H%M%S')}.png\"\n        )\n        screenshot_dir = os.path.join(os.getcwd(), \"screenshots\")\n        device.screenshot(screenshot_path)\n        allure.attach.file(screenshot_path, name=\"充值后截图\", attachment_type=allure.attachment_type.PNG)\n        # 断言：检查页面是否有充值成功后的元素（如头像或其他标志性元素）\n        # assert recharge_obj.is_el_exists(recharge_obj.manager.get_locator(\"imageView\").locator), \"断言失败\"\n        locator = ImageAI()\n        assert_result=locator.ai_assert(screenshot_path, \"判断是否充值成功，并返回判断结果成功或失败，若失败，附上失败原因\")\n        logging.info(f\"充值结果: {assert_result}\")\n>       assert \"成功\" in assert_result, f\"充值流程断言失败，{assert_result}\"\nE       AssertionError: 充值流程断言失败，失败，失败原因是充值卡无效（对应提示信息“10031:Invalid Recharge Card.”）。\nE       assert '\\u6210\\u529f' in '\\u5931\\u8d25\\uff0c\\u5931\\u8d25\\u539f\\u56e0\\u662f\\u5145\\u503c\\u5361\\u65e0\\u6548\\uff08\\u5bf9\\u5e94\\u63d0\\u793a\\u4fe1\\u606f\\u201c10031:Invalid Recharge Card.\\u201d\\uff09\\u3002'\n\ntestCase\\testApp\\recharge\\test_obj_recharge.py:48: AssertionError","steps":[],"attachments":[{"uid":"1f668de6bec286a6","name":"充值后截图","source":"1f668de6bec286a6.png","type":"image/png","size":175391},{"uid":"8fdc90a958bd972d","name":"AI日志分析建议_test_recharge_flow[0609@ipwangxin.cn-123456-0032585037446681]","source":"8fdc90a958bd972d.txt","type":"text/plain","size":568},{"uid":"20a8249316797a89","name":"用例执行失败截图_test_recharge_flow[0609@ipwangxin.cn-123456-0032585037446681]","source":"20a8249316797a89.png","type":"image/png","size":50959},{"uid":"5d515edac3b69337","name":"logcat_test_recharge_flow[0609@ipwangxin.cn-123456-0032585037446681]","source":"5d515edac3b69337.txt","type":"text/plain","size":960230},{"uid":"f9ebbf9e6be7efc2","name":"log","source":"f9ebbf9e6be7efc2.txt","type":"text/plain","size":768}],"parameters":[],"stepsCount":0,"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":true,"attachmentsCount":5},"afterStages":[{"name":"app_init::0","time":{"start":1750731633683,"stop":1750731633914,"duration":231},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"attachmentsCount":0}],"labels":[{"name":"story","value":"充值功能"},{"name":"parentSuite","value":"testCase.testApp.recharge"},{"name":"suite","value":"test_obj_recharge"},{"name":"host","value":"Ives-win10"},{"name":"thread","value":"23040-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"testCase.testApp.recharge.test_obj_recharge"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"code","value":"'0032585037446681'"},{"name":"password","value":"'123456'"},{"name":"username","value":"'0609@ipwangxin.cn'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"c82cad5fd7f8c2e5","status":"passed","time":{"start":1750731404982,"stop":1750731432358,"duration":27376}}],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":[]},"source":"318aa8b4cc6de5f5.json","parameterValues":["'0032585037446681'","'123456'","'0609@ipwangxin.cn'"]}